"use strict";(self.webpackChunkstrapi_project=self.webpackChunkstrapi_project||[]).push([[3990],{27846:(N,D,s)=>{s.d(D,{M:()=>U,S:()=>t,a:()=>L});var a=s(92132),e=s(54894),E=s(60074),M=s(88353),r=s(56654),m=s(56445),g=s(90625),A=s(84795),P=s(42638),h=s(63222);const L=({children:_,target:i})=>{const v=(0,m.hN)(),{formatMessage:c}=(0,e.A)(),{copy:I}=(0,m.iD)(),f=c({id:"app.component.CopyToClipboard.label",defaultMessage:"Copy to clipboard"}),o=async()=>{await I(i)&&v({type:"info",message:{id:"notification.link-copied"}})};return(0,a.jsx)(m.bQ,{endAction:(0,a.jsx)(M.K,{label:f,noBorder:!0,icon:(0,a.jsx)(g.A,{}),onClick:o}),title:i,titleEllipsis:!0,subtitle:_,icon:(0,a.jsx)("span",{style:{fontSize:32},children:"\u2709\uFE0F"}),iconBackground:"neutral100"})},U=({registrationToken:_})=>{const{formatMessage:i}=(0,e.A)(),v=`${window.location.origin}${(0,E.K)()}/auth/register?registrationToken=${_}`;return(0,a.jsx)(L,{target:v,children:i({id:"app.components.Users.MagicLink.connect",defaultMessage:"Copy and share this link to give access to this user"})})},t=({disabled:_,error:i,onChange:v,value:c})=>{const{isLoading:I,roles:f}=(0,h.u)(),{formatMessage:o}=(0,e.A)(),p=i?o({id:i,defaultMessage:i}):"",x=o({id:"app.components.Users.ModalCreateBody.block-title.roles",defaultMessage:"User's roles"}),Y=o({id:"app.components.Users.ModalCreateBody.block-title.roles.description",defaultMessage:"A user can have one or several roles"}),H=o({id:"app.components.Select.placeholder",defaultMessage:"Select"});return(0,a.jsx)(r.KF,{id:"roles",disabled:_,error:p,hint:Y,label:x,name:"roles",onChange:d=>{v({target:{name:"roles",value:d}})},placeholder:H,startIcon:I?(0,a.jsx)(T,{}):void 0,value:c.map(d=>d.toString()),withTags:!0,required:!0,children:f.map(d=>(0,a.jsx)(r.fe,{value:d.id.toString(),children:o({id:`global.${d.code}`,defaultMessage:d.name})},d.id))})},u=(0,P.i7)`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(359deg);
  }
`,W=P.Ay.div`
  animation: ${u} 2s infinite linear;
`,T=()=>(0,a.jsx)(W,{children:(0,a.jsx)(A.A,{})})},43990:(N,D,s)=>{s.d(D,{ProtectedEditPage:()=>ss});var a=s(92132),e=s(21272),E=s(38413),M=s(55356),r=s(85963),m=s(4198),g=s(94061),A=s(83997),P=s(30893),h=s(90151),L=s(68074),U=s(21610),t=s(56445),u=s(54514),W=s(46270),T=s(61535),_=s(35223),i=s(79275),v=s(54894),c=s(17703),I=s(71389),f=s(12083),o=s(60074),p=s(31956),x=s(27846),Y=s(97146),H=s(15126),d=s(63299),ds=s(67014),ls=s(59080),Es=s(14718),Ms=s(82437),ms=s(5790),Ps=s(5409),cs=s(74930),Os=s(2600),Ds=s(48940),gs=s(41286),As=s(51187),hs=s(56336),Ls=s(39404),vs=s(58692),fs=s(54257),Cs=s(501),Us=s(57646),us=s(23120),Is=s(44414),ps=s(25962),Bs=s(14664),Rs=s(42588),Ws=s(90325),Ts=s(62785),Ks=s(87443),js=s(41032),xs=s(22957),ys=s(93179),Ss=s(73055),zs=s(15747),Ns=s(85306),Ys=s(77965),Fs=s(26509),Vs=s(84624),$s=s(71210),Gs=s(32058),Qs=s(81185),Hs=s(82261),Js=s(72810),Zs=s(18022),Xs=s(63222);const w=f.Ik().shape({...Y.C,isActive:f.lc(),roles:f.YO().min(1,t.iW.required).required(t.iW.required)}),J=["email","firstname","lastname","username","isActive","roles"],k=()=>{const{formatMessage:n}=(0,v.A)(),B=(0,c.W5)("/settings/users/:id")?.params?.id??"",{push:R}=(0,c.W6)(),l=(0,t.hN)(),{lockApp:V,unlockApp:$}=(0,t.MA)(),Z=(0,o.p)(x.M,async()=>(await s.e(1704).then(s.bind(s,71704))).MagicLinkEE),{_unstableFormatAPIError:G,_unstableFormatValidationErrors:as}=(0,t.wq)(),X=(0,o.j)(p.s),{isLoading:ts,allowedActions:{canUpdate:Q}}=(0,t.ec)({read:X.settings?.users.read??[],update:X.settings?.users.update??[]}),[es]=(0,o.M)();(0,t.L4)();const{data:os,error:y,isLoading:ns}=(0,o.k)({id:B},{refetchOnMountOrArgChange:!0}),[S]=os?.users??[];if(e.useEffect(()=>{y&&(y.name==="UnauthorizedError"?(l({type:"info",message:{id:"notification.permission.not-allowed-read",defaultMessage:"You are not allowed to see this document"}}),R("/")):l({type:"warning",message:{id:"notification.error",defaultMessage:G(y)}}))},[y,G,R,l]),ns||!Z||ts)return(0,a.jsxs)(E.g,{"aria-busy":"true",children:[(0,a.jsx)(t.x7,{name:"Users"}),(0,a.jsx)(M.Q,{primaryAction:(0,a.jsx)(r.$,{disabled:!0,startIcon:(0,a.jsx)(u.A,{}),type:"button",size:"L",children:n({id:"global.save",defaultMessage:"Save"})}),title:n({id:"app.containers.Users.EditPage.header.label-loading",defaultMessage:"Edit user"}),navigationAction:(0,a.jsx)(U.N,{as:I.k2,startIcon:(0,a.jsx)(W.A,{}),to:"/settings/users?pageSize=10&page=1&sort=firstname",children:n({id:"global.back",defaultMessage:"Back"})})}),(0,a.jsx)(m.s,{children:(0,a.jsx)(t.Bl,{})})]});const z={...i(S,J),roles:S.roles.map(({id:C})=>C),password:"",confirmPassword:""},is=async(C,K)=>{V?.();const O=await es({id:B,..._(C,"confirmPassword")});"error"in O&&(0,o.x)(O.error)?(O.error.name==="ValidationError"&&K.setErrors(as(O.error)),l({type:"warning",message:G(O.error)})):(l({type:"success",message:n({id:"notification.success.saved",defaultMessage:"Saved"})}),K.setValues({...i(C,J),password:"",confirmPassword:""})),$?.()};return(0,a.jsxs)(E.g,{children:[(0,a.jsx)(t.x7,{name:"Users"}),(0,a.jsx)(T.l1,{onSubmit:is,initialValues:z,validateOnChange:!1,validationSchema:w,children:({errors:C,values:K,handleChange:O,isSubmitting:b,dirty:rs})=>(0,a.jsxs)(t.lV,{children:[(0,a.jsx)(M.Q,{primaryAction:(0,a.jsx)(r.$,{disabled:b||!Q?!0:!rs,startIcon:(0,a.jsx)(u.A,{}),loading:b,type:"submit",size:"L",children:n({id:"global.save",defaultMessage:"Save"})}),title:n({id:"app.containers.Users.EditPage.header.label",defaultMessage:"Edit {name}"},{name:z.username||(0,p.g)(z?.firstname??"",z.lastname)}),navigationAction:(0,a.jsx)(U.N,{as:I.k2,startIcon:(0,a.jsx)(W.A,{}),to:"/settings/users?pageSize=10&page=1&sort=firstname",children:n({id:"global.back",defaultMessage:"Back"})})}),(0,a.jsxs)(m.s,{children:[S?.registrationToken&&(0,a.jsx)(g.a,{paddingBottom:6,children:(0,a.jsx)(Z,{registrationToken:S.registrationToken})}),(0,a.jsxs)(A.s,{direction:"column",alignItems:"stretch",gap:7,children:[(0,a.jsx)(g.a,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,a.jsxs)(A.s,{direction:"column",alignItems:"stretch",gap:4,children:[(0,a.jsx)(P.o,{variant:"delta",as:"h2",children:n({id:"app.components.Users.ModalCreateBody.block-title.details",defaultMessage:"Details"})}),(0,a.jsx)(h.x,{gap:5,children:q.map(_s=>_s.map(j=>(0,a.jsx)(L.E,{...j.size,children:(0,a.jsx)(t.ah,{...j,disabled:!Q,error:C[j.name],onChange:O,value:K[j.name]})},j.name)))})]})}),(0,a.jsx)(g.a,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,a.jsxs)(A.s,{direction:"column",alignItems:"stretch",gap:4,children:[(0,a.jsx)(P.o,{variant:"delta",as:"h2",children:n({id:"global.roles",defaultMessage:"User's role"})}),(0,a.jsx)(h.x,{gap:5,children:(0,a.jsx)(L.E,{col:6,xs:12,children:(0,a.jsx)(x.S,{disabled:!Q,error:C.roles,onChange:O,value:K.roles})})})]})})]})]})]})})]})},q=[[{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},name:"firstname",placeholder:{id:"Auth.form.firstname.placeholder",defaultMessage:"e.g. Kai"},type:"text",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},name:"lastname",placeholder:{id:"Auth.form.lastname.placeholder",defaultMessage:"e.g. Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},name:"email",placeholder:{id:"Auth.form.email.placeholder",defaultMessage:"e.g. kai.doe@strapi.io"},type:"email",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.username.label",defaultMessage:"Username"},name:"username",placeholder:{id:"Auth.form.username.placeholder",defaultMessage:"e.g. Kai_Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"global.password",defaultMessage:"Password"},name:"password",type:"password",size:{col:6,xs:12},autoComplete:"new-password"},{intlLabel:{id:"Auth.form.confirmPassword.label",defaultMessage:"Password confirmation"},name:"confirmPassword",type:"password",size:{col:6,xs:12},autoComplete:"new-password"}],[{intlLabel:{id:"Auth.form.active.label",defaultMessage:"Active"},name:"isActive",type:"bool",size:{col:6,xs:12}}]],ss=()=>{const n=(0,t.hN)(),F=(0,o.j)(p.s),{isLoading:B,allowedActions:{canRead:R,canUpdate:l}}=(0,t.ec)({read:F.settings?.users.read??[],update:F.settings?.users.update??[]}),{state:V}=(0,c.zy)(),$=V?.from??"/";return e.useEffect(()=>{B||!R&&!l&&n({type:"info",message:{id:"notification.permission.not-allowed-read",defaultMessage:"You are not allowed to see this document"}})},[B,R,l,n]),B?(0,a.jsx)(t.Bl,{}):!R&&!l?(0,a.jsx)(c.rd,{to:$}):(0,a.jsx)(k,{})}},63222:(N,D,s)=>{s.d(D,{u:()=>r});var a=s(21272),e=s(56445),E=s(54894),M=s(60074);const r=(m={},g)=>{const{locale:A}=(0,E.A)(),P=(0,e.QM)(A,{sensitivity:"base"}),{data:h,error:L,isError:U,isLoading:t,refetch:u}=(0,M.z)(m,g);return{roles:a.useMemo(()=>[...h??[]].sort((T,_)=>P.compare(T.name,_.name)),[h,P]),error:L,isError:U,isLoading:t,refetch:u}}},97146:(N,D,s)=>{s.d(D,{C:()=>E});var a=s(56445),e=s(12083);const E={firstname:e.Yj().trim().required(a.iW.required),lastname:e.Yj(),email:e.Yj().email(a.iW.email).lowercase().required(a.iW.required),username:e.Yj().nullable(),password:e.Yj().min(8,a.iW.minLength).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"),confirmPassword:e.Yj().min(8,a.iW.minLength).oneOf([e.KR("password"),null],"components.Input.error.password.noMatch").when("password",(M,r)=>M?r.required(a.iW.required):r)}}}]);
